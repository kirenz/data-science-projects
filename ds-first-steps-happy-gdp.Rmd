---
title: "First steps in Data Science"
subtitle: "Does money make people happier?"
author: "Prof. Dr. Jan Kirenz, HdM Stuttgart"
output:
 html_document:
  code_download: true
  fig_height: 6
  fig_width: 8
  highlight: tango
  number_sections: yes
  toc: yes
  toc_depth: 3
  toc_float: 
    collapsed: false
    smooth_scroll: true 
  theme: paper
  df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```


# Setup

```{r}

# Common packages
library(tidyverse) # collection of data science packages
library(janitor) # data preparation package
library(kableExtra) # get nice HTML tables
```

# Data import

```{r}

# Load the data from GitHub
LINK = "https://raw.githubusercontent.com/kirenz/datasets/master/oecd_gdp.csv"

df <- read_csv(LINK)

# Change column names
df <-  clean_names(df)

# Visualize the data
ggplot(df, aes(x=gdp_per_capita, 
               y=life_satisfaction)) +
  geom_point() +
  theme_classic()

```


# Simple linear regression model

```{r}
library(tidymodels)

# Select a linear regression model
lm_mod <- 
  linear_reg() %>% 
  set_engine("lm")

# Train the model
lm_fit <- 
  lm_mod %>% 
  fit(life_satisfaction ~ gdp_per_capita, data = df)

# Model summary
tidy(lm_fit)

# Make a prediction for a new GDP value
# and print HTML-friendly output with kable()

X_new <-  tibble(gdp_per_capita = c(50000)) # new GDP per capita

kable(predict(lm_fit, new_data = X_new))

```

# K-Nearest Neighbor Model

```{r}

library(kknn)

knn_mod <- 
  nearest_neighbor(neighbors = 3) %>% 
  set_engine("kknn") %>% 
  set_mode("regression") 

knn_fit <- 
  knn_mod %>% 
  fit(life_satisfaction ~ gdp_per_capita, data = df)

kable(predict(knn_fit, new_data = X_new)) 

```




